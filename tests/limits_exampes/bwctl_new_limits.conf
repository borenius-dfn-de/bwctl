<class "root_users">
    # No parent class

    # Applies to all tests
    <default_limits>
        duration     60
        bandwidth    100M
    </default_limits>

    # Applies to all throughput tests (i.e. iperf, iperf3, nuttcp), overriding
    # the defaults. Note: unlike in the previous syntax, you can go above the
    # defaults.
    <limits "throughput">
        duration      30
        bandwidth     10G
        allow_udp_throughput     on
    </limits>

    # Applies to all latency tests (i.e. ping and owamp).
    <limits "latency">
        # Only permit latency tests of 100 pps or less
        packets_per_second      100
    </limits>
</class>

<class "loopback_users”>
    # inherits all the limits from root_users
    parent           “root_users"

    # Allow users on the same box as bwctl to perform tests where the remote
    # side isn't running bwctl (e.g. to allow them to do traceroute tests to
    # any given host without allowing "the world" to do the same)
    <default_limits>
        allow_no_endpoint    on
    </limits>
</class>

<class "local_users”>
    # inherit all the limits from root_users
    parent           “root_users”

    # No default limits so we just inherit the limits from "root_users"

    # Turn off UDP tests throughput tests, and limit the duration to 20 seconds
    <limits “throughput”>
        allow_udp_throughput    off
        duration      20
    </limits>

    # Allow them to run 30 second iperf3 tests (for some reason...)
    <limits “iperf3”>
        duration      30
    </limits>
</class>

<class "anonymous_users”>
    # inherits all the limits from local_users
    parent           “local_users"

    # Only allow anonymous users to perform 4 tests per 24 hour period
    <limits “throughput”>
        test_frequency    4/24h
    </limits>

    # Set a minimum TTL for anonymous users to minimize how much they can map
    # out your network
    <limits "traceroute">
        # Require the TTL to be at least 3
        minimum_ttl      3
    </limits>
</class>

# Assign this network to the local_users class
assign network 192.168.1.0/24  “local_users”

# Assign this user to the root_users class
assign user root “root_users”

# Assign users running on the same box as the bwctl server to this class
assign loopback “loopback_users”

# Assign anything that doesn’t match the above to this class
assign default “anonymous_users”
